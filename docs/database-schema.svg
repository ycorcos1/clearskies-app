<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800" font-family="Arial, sans-serif">
  <!-- Background -->
  <rect width="1200" height="800" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#1e293b">ClearSkies Firestore Database Schema</text>
  
  <!-- Students Collection -->
  <rect x="50" y="80" width="200" height="200" fill="#ffffff" stroke="#3b82f6" stroke-width="2" rx="8"/>
  <text x="150" y="105" font-size="16" font-weight="bold" text-anchor="middle" fill="#1e40af">students</text>
  <line x1="50" y1="120" x2="250" y2="120" stroke="#3b82f6" stroke-width="1"/>
  <text x="60" y="145" font-size="12" fill="#64748b">id (PK)</text>
  <text x="60" y="165" font-size="12" fill="#64748b">name</text>
  <text x="60" y="185" font-size="12" fill="#64748b">email</text>
  <text x="60" y="205" font-size="12" fill="#64748b">phone</text>
  <text x="60" y="225" font-size="12" fill="#64748b">trainingLevel</text>
  <text x="60" y="245" font-size="12" fill="#64748b">settings</text>
  <text x="60" y="265" font-size="12" fill="#64748b">createdAt</text>
  
  <!-- Bookings Collection -->
  <rect x="350" y="80" width="200" height="280" fill="#ffffff" stroke="#10b981" stroke-width="2" rx="8"/>
  <text x="450" y="105" font-size="16" font-weight="bold" text-anchor="middle" fill="#047857">bookings</text>
  <line x1="350" y1="120" x2="550" y2="120" stroke="#10b981" stroke-width="1"/>
  <text x="360" y="145" font-size="12" fill="#64748b">id (PK)</text>
  <text x="360" y="165" font-size="12" fill="#64748b">studentId (FK)</text>
  <text x="360" y="185" font-size="12" fill="#64748b">studentName</text>
  <text x="360" y="205" font-size="12" fill="#64748b">trainingLevel</text>
  <text x="360" y="225" font-size="12" fill="#64748b">scheduledDate</text>
  <text x="360" y="245" font-size="12" fill="#64748b">scheduledTime</text>
  <text x="360" y="265" font-size="12" fill="#64748b">departureLocation</text>
  <text x="360" y="285" font-size="12" fill="#64748b">status</text>
  <text x="360" y="305" font-size="12" fill="#64748b">weatherStatus</text>
  <text x="360" y="325" font-size="12" fill="#64748b">lastWeatherCheck</text>
  <text x="360" y="345" font-size="12" fill="#64748b">createdAt</text>
  
  <!-- AI Reschedules Subcollection -->
  <rect x="650" y="80" width="200" height="200" fill="#ffffff" stroke="#f59e0b" stroke-width="2" rx="8"/>
  <text x="750" y="105" font-size="16" font-weight="bold" text-anchor="middle" fill="#b45309">aiReschedules</text>
  <text x="750" y="125" font-size="11" text-anchor="middle" fill="#92400e">(subcollection)</text>
  <line x1="650" y1="140" x2="850" y2="140" stroke="#f59e0b" stroke-width="1"/>
  <text x="660" y="165" font-size="12" fill="#64748b">id (PK)</text>
  <text x="660" y="185" font-size="12" fill="#64748b">explanation</text>
  <text x="660" y="205" font-size="12" fill="#64748b">suggestions[]</text>
  <text x="660" y="225" font-size="12" fill="#64748b">trainingLevel</text>
  <text x="660" y="245" font-size="12" fill="#64748b">violations[]</text>
  <text x="660" y="265" font-size="12" fill="#64748b">createdAt</text>
  
  <!-- Notification Queue -->
  <rect x="50" y="400" width="200" height="280" fill="#ffffff" stroke="#8b5cf6" stroke-width="2" rx="8"/>
  <text x="150" y="425" font-size="16" font-weight="bold" text-anchor="middle" fill="#6d28d9">notificationQueue</text>
  <line x1="50" y1="440" x2="250" y2="440" stroke="#8b5cf6" stroke-width="1"/>
  <text x="60" y="465" font-size="12" fill="#64748b">id (PK)</text>
  <text x="60" y="485" font-size="12" fill="#64748b">bookingId (FK)</text>
  <text x="60" y="505" font-size="12" fill="#64748b">studentId (FK)</text>
  <text x="60" y="525" font-size="12" fill="#64748b">type</text>
  <text x="60" y="545" font-size="12" fill="#64748b">channel</text>
  <text x="60" y="565" font-size="12" fill="#64748b">status</text>
  <text x="60" y="585" font-size="12" fill="#64748b">attempts</text>
  <text x="60" y="605" font-size="12" fill="#64748b">scheduledAt</text>
  <text x="60" y="625" font-size="12" fill="#64748b">payload</text>
  <text x="60" y="645" font-size="12" fill="#64748b">createdAt</text>
  <text x="60" y="665" font-size="12" fill="#64748b">lastError</text>
  
  <!-- Notification Events -->
  <rect x="350" y="400" width="200" height="240" fill="#ffffff" stroke="#ec4899" stroke-width="2" rx="8"/>
  <text x="450" y="425" font-size="16" font-weight="bold" text-anchor="middle" fill="#be185d">notificationEvents</text>
  <line x1="350" y1="440" x2="550" y2="440" stroke="#ec4899" stroke-width="1"/>
  <text x="360" y="465" font-size="12" fill="#64748b">id (PK)</text>
  <text x="360" y="485" font-size="12" fill="#64748b">bookingId (FK)</text>
  <text x="360" y="505" font-size="12" fill="#64748b">studentId (FK)</text>
  <text x="360" y="525" font-size="12" fill="#64748b">type</text>
  <text x="360" y="545" font-size="12" fill="#64748b">channel</text>
  <text x="360" y="565" font-size="12" fill="#64748b">status</text>
  <text x="360" y="585" font-size="12" fill="#64748b">attempt</text>
  <text x="360" y="605" font-size="12" fill="#64748b">messageId</text>
  <text x="360" y="625" font-size="12" fill="#64748b">errorMessage</text>
  <text x="360" y="645" font-size="12" fill="#64748b">createdAt</text>
  
  <!-- Error Logs -->
  <rect x="650" y="400" width="200" height="200" fill="#ffffff" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="750" y="425" font-size="16" font-weight="bold" text-anchor="middle" fill="#991b1b">errorLogs</text>
  <line x1="650" y1="440" x2="850" y2="440" stroke="#ef4444" stroke-width="1"/>
  <text x="660" y="465" font-size="12" fill="#64748b">id (PK)</text>
  <text x="660" y="485" font-size="12" fill="#64748b">type</text>
  <text x="660" y="505" font-size="12" fill="#64748b">message</text>
  <text x="660" y="525" font-size="12" fill="#64748b">bookingId (FK?)</text>
  <text x="660" y="545" font-size="12" fill="#64748b">studentId (FK?)</text>
  <text x="660" y="565" font-size="12" fill="#64748b">retryCount</text>
  <text x="660" y="585" font-size="12" fill="#64748b">resolved</text>
  <text x="660" y="605" font-size="12" fill="#64748b">timestamp</text>
  
  <!-- Relationships: Students to Bookings -->
  <path d="M 250 180 L 350 180" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="300" y="175" font-size="11" fill="#3b82f6" text-anchor="middle">1:N</text>
  
  <!-- Relationships: Bookings to AI Reschedules -->
  <path d="M 550 220 L 650 220" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="600" y="215" font-size="11" fill="#10b981" text-anchor="middle">1:N</text>
  
  <!-- Relationships: Bookings to Notification Queue -->
  <path d="M 450 360 L 150 400" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="300" y="385" font-size="11" fill="#10b981" text-anchor="middle">1:N</text>
  
  <!-- Relationships: Students to Notification Queue -->
  <path d="M 150 280 L 150 400" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="160" y="340" font-size="11" fill="#3b82f6">1:N</text>
  
  <!-- Relationships: Bookings to Notification Events -->
  <path d="M 450 360 L 450 400" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="460" y="380" font-size="11" fill="#10b981">1:N</text>
  
  <!-- Relationships: Students to Notification Events -->
  <path d="M 150 280 L 450 400" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Relationships: Bookings to Error Logs (optional) -->
  <path d="M 550 300 L 650 500" stroke="#10b981" stroke-width="1.5" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="600" y="405" font-size="10" fill="#64748b" text-anchor="middle">optional</text>
  
  <!-- Relationships: Students to Error Logs (optional) -->
  <path d="M 150 280 L 750 500" stroke="#3b82f6" stroke-width="1.5" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#64748b"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <rect x="900" y="80" width="280" height="200" fill="#ffffff" stroke="#64748b" stroke-width="1" rx="8"/>
  <text x="1040" y="105" font-size="14" font-weight="bold" text-anchor="middle" fill="#1e293b">Legend</text>
  <line x1="910" y1="115" x2="1170" y2="115" stroke="#64748b" stroke-width="1"/>
  <text x="920" y="140" font-size="12" fill="#64748b">PK = Primary Key</text>
  <text x="920" y="160" font-size="12" fill="#64748b">FK = Foreign Key</text>
  <text x="920" y="180" font-size="12" fill="#64748b">FK? = Optional Foreign Key</text>
  <line x1="920" y1="195" x2="1170" y2="195" stroke="#e5e7eb" stroke-width="1"/>
  <text x="920" y="220" font-size="11" fill="#64748b">Solid line = Required</text>
  <text x="920" y="240" font-size="11" fill="#64748b">Dashed line = Optional</text>
  <text x="920" y="260" font-size="11" fill="#64748b">1:N = One-to-Many</text>
</svg>


